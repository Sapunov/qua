### Поиск

- GET **/search** - поиск по введенному тексу
    - query - текст запроса
    - spelling - включена или выключена коррекция запроса (по умолчанию включена)
    - limit - сколько результатов должно быть получено
    - offset - сдвиг относительно начала набора результатов

Формат данных:

`GET` **/api/search?query=друг&spelling=0&offset=0&limit=10**

```
{
    "ok": 1,
    "response": {
        "hits": [
            {
                "id": 1,
                "image": null,
                "is_external": false,
                "resource": null,
                "keywords": ["one", "two"],
                "score": 1.0,
                "snippet": "Привет тебе друг",
                "title": "Привет тебе друг",
                "url_params": {
                    "qid": 1,
                    "shid": 47,
                    "token": "91727aa95d47fcdc9966",
                    "track": "search_internal"
                }
            },
            {
                "id": 1,
                "image": "/static/images/jsifucwer.jpg",
                "is_external": true,
                "resource": "en.wikipedia.org",
                "keywords": null,
                "score": 0.45,
                "snippet": "Привет тебе друг",
                "title": "Привет тебе друг мой",
                "url": "/away?track=search_external&shid=158&qid=6&token=29f0e3a50514dd530717&redirect_url=https://en.wikipedia.org/wiki/Friendship"
            },
            ...
        ],
        "query": "друк",
        "query_was_corrected": true,
        "total": 20,
        "used_query": "друг",
        "took": 0.087,
        "pagination": {
            "next": "/api/search?query=друг&spelling=0&offset=10&limit=10",
            "prev": null
        }
    }
}
```

**query_was_corrected** - принимает значение `true` когда система посчитала, что
запрос неправильный и изменила его. В поле `query` всегда будет тот запрос, который
ввел пользователь, а в поле `used_query` будет находится тот запрос, который действительно
был использован в данном поиске.

Чтобы выполнить запрос без коррекции (как есть), нужно выполнить запрос:
`/api/search?query=друг&spelling=0`

**used_query** - тот запрос, который действительно использовался при поиске.
В слечае исправленной ошибки в запросе в этом поле будет корректный запрос.


**hit.url** - адрес для переадресации при переходе к ответу. Стоит делать
честный http редирукт на этот адрес с открытием дополнительного окна (`target="blank"`).

В данной url содержатся параметры отслеживания и именно поэтому стоит использовать именно его.

**hit.is_external** - флаг, показывающий является ли результат вопросом, созданным  в QUA,
или же вопрос является внешним ресурсом (страницей документации, документом на jive и пр.).

Если данный флаг установлен в `true`, то нужно сделать редирект на `hit.url`

`id` в данном случае будет относится к коллекции `external_resources`, то есть можно будет
изъять информацию о ресурсе с помощью запроса `/api/extermnal_serources/<int:id>`


**url_params** - данное поле присутствует только в тех случаях, когда найденный ответ
является внутренним вопросом QUA и нужно открыть страницу внутри JS приложения.


**hit.resource** - это ресурс, с которого есть ответ. Если там написано доменное имя, значит,
этот ответ оттуда и при нажатии на ответ пользователь перейдет именно на этот ресурс, а не внутри qua.
В поле может быть `null`, это будет означать, что вопрос внутренний. Надо бы это тоже как-то
отразить в поисковой выдаче.


**took** - время выполнения запроса в секундах. Это число берется из поля `took` elasticsearch,
поэтому может не отражать действительности так как кроме запроса к elasticsearch происходит
еще много магии.

**pagination** - ссылки для обеспечения пагинации. Если в одну либо другую сторону больше не результатов, то будет `null`
